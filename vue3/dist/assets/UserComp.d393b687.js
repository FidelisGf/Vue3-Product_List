import{at as l,af as R,u as d,K as D,c as E,r as u}from"./index.bfab535e.js";import{C as k}from"./CRUD.ebf42a23.js";const i={register(t){return l.post("/register",t)},login(t){return l.post("/login",t)},logout(){return l.get("/logout")},getPerfil(){return l.get("/getPerfilUserInternet")},update(t){return l.post("usuariosUp",t)},checkIfPassword(t){return l.get("checkIfPassword",{params:{PASSWORD:t.PASSWORD,ID:t.ID}})}},I=R("user",{state:()=>({}),actions:{async registerUser(t){const s=d();return i.register(t).then(n=>(s.activeSnack(n.data.message),!0)).catch(n=>{let a="Erro :"+n.response.data.message;return s.activeSnack(a),!1})},async updateUser(t,s){const r=d();return i.update(t).then(a=>(r.activeSnack(a.data.message),!0)).catch(a=>{let S="Erro :"+a.response.data.message;return r.activeSnack(S),!1})},async getUser(){return i.getPerfil().then(s=>s.data)},async checkIfPassword(t){return i.checkIfPassword(t).then(r=>r.data).catch(r=>r)},loginUser(t){const s=d();return i.login(t).then(n=>(localStorage.setItem("tkn",n.data.access_token),s.activeSnack("Login realizado com sucesso !"),!0)).catch(n=>(s.activeSnack("Error : "+n.response.data.message),!1))},logoutUser(){i.logout().then(t=>{console.log(t)}).catch(t=>(console.log(t),t))}}});function L(){const t=d(),{isNull:s}=k(),r=I(),n=D();E(()=>v());const a={ID:u(0),NAME:u(""),PASSWORD:u(""),EMAIL:u(""),CF_PASSWORD:u(""),CPF:u(""),IMAGE:u("")};function S(){a.CF_PASSWORD.value="",a.PASSWORD.value="",a.CPF.value="",a.NAME.value="",a.EMAIL.value=""}function v(){return a.NAME.value.length>=4}async function A(e,p){if(p)if(a.CF_PASSWORD.value==a.PASSWORD.value){let o=new FormData;o.append("NAME",a.NAME.value),o.append("PASSWORD",a.PASSWORD.value),o.append("EMAIL",a.EMAIL.value),o.append("CPF",a.CPF.value),(e.value!=null||e.value!=null)&&o.append("IMAGE",e.value,e.value.name),o.append("SALARIO",parseFloat(0)),await r.registerUser(o)==!0&&(console.log("Entrou"),n.push({path:"/login"}))}else t.activeSnack("As senhas divergem");else t.activeSnack("Dados inv\xE1lidos")}async function f(e,p){if(p)if(a.CF_PASSWORD.value==a.PASSWORD.value){let o={ID:a.ID.value,PASSWORD:a.PASSWORD.value},g=await r.checkIfPassword(o);if(g){console.log(g);let c=new FormData;c.append("ID",a.ID.value),c.append("NAME",a.NAME.value),c.append("EMAIL",a.EMAIL.value),c.append("CPF",a.CPF.value),c.append("SALARIO",parseFloat(0)),(e.value!=null||e.value!=null)&&c.append("IMAGE",e.value,e.value.name),await r.updateUser(c)==!0&&n.push({path:"/perfil"})}else t.activeSnack("Essa n\xE3o \xE9 sua senha")}else t.activeSnack("As senhas divergem");else t.activeSnack("Dados inv\xE1lidos")}async function h(){let e=new FormData;e.append("NAME",a.NAME.value),e.append("PASSWORD",a.PASSWORD.value),await r.loginUser(e)==!0&&(console.log("aaa"),n.push({path:"/produtos"}))}function m(){r.logoutUser(),localStorage.clear("token"),n.push("/login")}function P(){return r.getUser()}return{user:a,register:A,clearUser:S,login:h,logout:m,getPerfil:P,update:f,isNull:s,NomeRules:[e=>!!e||"Nome \xE9 obrigatorio",e=>e&&e.length>=6||"Nome deve ter no minimo 6 caracteres"],cpfRules:[e=>!!e||"Cpf \xE9 obrigatorio",e=>e&&e.length==11||"Cpf inv\xE1lido"],EmailRules:[e=>!!e||"Email \xE9 obrigatorio",e=>/.+@.+\..+/.test(e)||"Email deve ser v\xE1lido"],pwRules:[e=>!!e||"Senha \xE9 obrigatoria",e=>e&&e.length>=6||"Senha deve ter no minimo 6 caracteres"],cfPwRules:[e=>!!e||"Confirmar a senha \xE9 obrigatorio",e=>e==a.PASSWORD.value||"As senhas n\xE3o conferem"]}}export{L as U};
